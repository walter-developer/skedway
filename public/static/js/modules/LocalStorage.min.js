export default class LocalStorage{set(index,value=null){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),lastValue=self.get(first,{}),parse=value&&"string"==typeof value;if(parse=parse&&(value.match(/\{/g)||[]).length,parse=parse&&(value.match(/\}/g)||[]).length,value=parse?JSON.parse(value):value,keys.length>0)return lastValue="object"==typeof lastValue?lastValue:{},lastValue=self._set(lastValue,next,value),localStorage.setItem(first,JSON.stringify(lastValue)),!0;if(first){let newValue="object"==typeof value?JSON.stringify(value):value;return localStorage.setItem(first,newValue),!0}return!1}catch(e){return console.log(e),alert("Erro ao adicionar dados em local storage!"),null}}get(index,value=null){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),search=null;if(localStorage.length>0){search=localStorage.getItem(first);let parse=search&&"string"==typeof search;return parse=parse&&(search.match(/\{/g)||[]).length,parse=parse&&(search.match(/\}/g)||[]).length,search=parse?JSON.parse(search):search,first&&search&&keys.length>0&&"object"==typeof search?(search=self._get(search,next),null==search?value:search):first&&search&&keys.length<=0?null==search?value:search:value}return value}catch(e){return console.log(e),alert("Erro ao listar dados em local storage!"),null}}all(){try{let self=this,list={};if(localStorage.length<0)return list;for(let i=0;i<localStorage.length;i++){let key=localStorage.key(i);list[key]=self.get(key)}return list}catch(e){return console.log(e),alert("Erro ao listar todos os dados em local storage!"),null}}delete(index){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),objSearch=self.get(first);if(first&&keys.length>0&&"object"==typeof objSearch){let newValue=self._delete(objSearch,next);return self.set(first,newValue),!0}return!!(first&&keys.length<=0)&&(localStorage.removeItem(first),!0)}catch(e){return console.log(e),alert("Erro ao deletar dados em local storage!"),null}}_set(obj={},index=null,value=null){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),newObj=obj&&"object"==typeof obj?obj:{};if(keys.length>0){let last=first in newObj&&"object"==typeof newObj[first];return newObj[first]=self._set(last?newObj[first]:{},next,value),newObj}return newObj[first]=value,newObj}catch(e){return console.log(e),alert("Erro ao adicionar dados recursivos em session storage!"),null}}_get(obj={},index){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),newObj=obj&&"object"==typeof obj?obj:{},getItem=first&&first.length;getItem=getItem&&keys.length<=0,getItem=getItem&&first in newObj;let findItem=first&&first.length;if(findItem=findItem&&keys.length>0,findItem=findItem&&first in newObj,findItem=findItem&&"object"==typeof newObj[first],getItem)return newObj[first];if(findItem){let objSearch=newObj[first];return self._get(objSearch,next)}return null}catch(e){return console.log(e),alert("Erro ao listar dados recursivos em session storage!"),null}}_delete(obj={},index){try{let self=this,keys=index.split(".").filter(v=>v.length>0),first=keys.shift(),next=keys.join("."),deleteItem=first&&first.length,newObj=obj&&"object"==typeof obj?obj:{};deleteItem=deleteItem&&keys.length<=0,deleteItem=deleteItem&&first in newObj;let findItem=first&&first.length;if(findItem=findItem&&keys.length>0,findItem=findItem&&first in newObj,deleteItem)return delete newObj[first],newObj;if(findItem){let objSearch=newObj[first];return newObj[first]=self._delete(objSearch,next),newObj}return obj}catch(e){return console.log(e),alert("Erro ao listar dados recursivos em session storage!"),null}}}