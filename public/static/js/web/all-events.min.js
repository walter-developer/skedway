import Collection from"./../modules/Collection.js";import Timezone from"./../modules/timezone.min.js";import{URL,TABULATOR_CONFIGURATION}from"./../constants/Constants.min.js";export default new class AllEvents{timezone;constructor(){let self=this;this.timezone=new Timezone,this.events()}events(){let self=this,conf={...TABULATOR_CONFIGURATION};conf.data=null,conf.placeholder="Nenhum evento encontrado!",conf.ajaxURL=URL+"/listing/events/data",conf.columns=[{title:"+",formatter:"responsiveCollapse",minWidth:50,hozAlign:"left",resizable:!1,headerSort:!1},{title:"Evento",field:"id",hozAlign:"center",sorter:"number"},{title:"Título",field:"title",sorter:"string",formatter:"string"},{title:"Início",field:"start",sorter:"string",formatter:"string"},{title:"Final",field:"end",sorter:"string",formatter:"string"},{title:"Data Cadastro",field:"created_at",sorter:"string",formatter:"string"},{title:"Data Edição",field:"updated_at",sorter:"string",formatter:"string"},{title:"Deletar",field:"link_delete",hozAlign:"center",sorter:"string",formatter:"html"},{title:"Editar",field:"link_update",hozAlign:"center",sorter:"string",formatter:"html"}],conf.ajaxParams=function(){var values={};return this.getSorters().forEach((function(value){"object"==typeof value&&(orders[value.field]=value.dir)})),values.page=this.getPage(),values.limit=this.getPageSize(),values},conf.ajaxResponse=function(url,params,data){let selfTabulator=this,collection=new Collection(data).toObject();return collection.forEach((function(item){let id=item.get("id",0),linkDelete=null,linkUpdate=null;return linkDelete='<a href="'+URL+"/events/delete/"+id+'">Deletar #'+id+"</a>",linkUpdate='<a href="'+URL+"/events/"+id+'">Editar #'+id+"</a>",item.set("start",self.timezone.format(self.timezone.convertUTCDateToLocalDate(new Date(item.get("start"))),"d/m/y h:i:s")),item.set("end",self.timezone.format(self.timezone.convertUTCDateToLocalDate(new Date(item.get("end"))),"d/m/y h:i:s")),item.set("created_at",item.get("created_at")?self.timezone.format(self.timezone.convertUTCDateToLocalDate(new Date(item.get("created_at"))),"d/m/y h:i:s"):null),item.set("updated_at",item.get("updated_at")?self.timezone.format(self.timezone.convertUTCDateToLocalDate(new Date(item.get("updated_at"))),"d/m/y h:i:s"):null),item.set("link_delete",linkDelete),item.set("link_update",linkUpdate),item})),{url:url,data:Object.values(collection.all()),params:params,last_page:this.getPageMax()}};let tabulator=new Tabulator("#table-events",conf);return tabulator.setData(),tabulator}};